import{e,a1 as l,o as t,c as a,w as o,k as r,p as n,n as s,u as i,q as u,x as c,E as d,F as p,O as v,f as h,L as b,M as m,a3 as f,H as y,s as w,a as x,h as z,v as g}from"./@vue.1c8907e1.js";import{t as E,d as S,c as _}from"./lodash-es.4d7e79d7.js";var T=Object.defineProperty,L=Object.defineProperties,P=Object.getOwnPropertyDescriptors,H=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,$=(e,l,t)=>l in e?T(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t,O=(e,l)=>{for(var t in l||(l={}))M.call(l,t)&&$(e,t,l[t]);if(H)for(var t of H(l))I.call(l,t)&&$(e,t,l[t]);return e},D=(e,l)=>L(e,P(l));const j=["onPointerdown"];const A=e(D(O({},{name:"ScrollbarThumb"}),{props:{type:null,autoExpand:null,autoHide:null,autoHideDelay:null,fixedThumb:null,scrollInfo:null,wrapperEl:null},setup:function(e,{expose:t}){const c=e;let d=null,v=l(null);const x={pageX:0,pageY:0,scrollPos:0};let z=null;const g=()=>{d=setTimeout((()=>{v.value&&v.value.classList.remove("scrollbar__thumbPlaceholder--scrolling"),d=null}),c.autoHideDelay)},S=()=>{null!==d&&clearTimeout(d)};h(S);const _=E((e=>{e.stopPropagation(),e.preventDefault();const l="horizontal"===c.type?"pageX":"pageY",t=(e[l]-x[l])/c.scrollInfo.wrapperMainSize*c.scrollInfo.contentMainSize;c.wrapperEl.scrollTo({["horizontal"===c.type?"left":"top"]:x.scrollPos+t,behavior:"auto"})}),16),T=()=>{g(),v.value.removeEventListener("pointermove",_),v.value.removeEventListener("pointerup",T),v.value.removeEventListener("pointercancel",T),v.value.removeEventListener("mousewheel",T),document.removeEventListener("mousewheel",T),"number"==typeof z&&v.value.releasePointerCapture(z),z=null},L=e=>{e.ctrlKey||0!==e.button||(S(),x.pageX=e.pageX,x.pageY=e.pageY,x.scrollPos=c.wrapperEl["horizontal"===c.type?"scrollLeft":"scrollTop"],z=null==e?void 0:e.pointerId,v.value.setPointerCapture(z),v.value.addEventListener("pointermove",_),v.value.addEventListener("pointerup",T),v.value.addEventListener("pointercancel",T),v.value.addEventListener("mousewheel",T,{passive:!1}),document.addEventListener("mousewheel",T,{passive:!1}),v.value.classList.add("scrollbar__thumbPlaceholder--scrolling"))};t({autoHideAfterScroll:()=>{S(),v.value&&v.value.classList.add("scrollbar__thumbPlaceholder--scrolling"),g()}});let P=l(!1),H=l(!1),M=l(null),I=null,$=null,O=a((()=>c.fixedThumb&&!H.value));const D=([e])=>H.value=e.isIntersecting,A=([e])=>P.value=e.isIntersecting,k=()=>{I&&(I.disconnect(),I=null),$&&($.disconnect(),$=null)};return o((()=>[c.fixedThumb,c.wrapperEl]),(()=>{if(!c.fixedThumb||!c.wrapperEl)return k();k(),$=new IntersectionObserver(A,{threshold:[0,.5]}),$.observe(c.wrapperEl),I=new IntersectionObserver(D),I.observe(M.value)})),h(k),(l,t)=>(r(),n(p,null,[b(s("div",{class:i(["scrollbar__thumbPlaceholder",`scrollbar__thumbPlaceholder--${e.type}`,{"scrollbar__thumbPlaceholder--autoHide":e.autoHide,"scrollbar__thumbPlaceholder--autoExpand":e.autoExpand}]),style:u({width:"horizontal"===e.type?`${e.scrollInfo.thumbSize}px`:"",height:"vertical"===e.type?`${e.scrollInfo.thumbSize}px`:"",position:O.value?"fixed":"absolute",["vertical"===e.type?"top":"left"]:O.value?`${e.scrollInfo.boundaryDistance+3}px`:"3px"}),ref:(e,l)=>{l.thumbEl=e,v.value=e},onPointerdown:y(L,["stop"])},[t[0]||(f(-1),t[0]=s("div",{class:i(["scrollbar__thumb",`scrollbar__thumb--${e.type}`])},null,2),f(1),t[0])],46,j),[[m,Boolean(e.scrollInfo.thumbSize)&&(!e.fixedThumb||P.value)]]),c.fixedThumb?b((r(),n("div",{key:0,ref:(e,l)=>{l.shepherdEl=e,M.value=e},class:i(["scrollbar__shepherd",`scrollbar__shepherd--${e.type}`])},null,2)),[[m,Boolean(e.scrollInfo.thumbSize)]]):w("",!0)],64))}})),k={wait:333,type:"debounce"};function C(...e){const t="value"in(null==e?void 0:e[0]);let a;a=t?null==e?void 0:e[1]:null==e?void 0:e[0];const{wait:o,type:r,callback:n}=O(O({},k),a),s=t?e[0]:l(null),i=x({left:0,top:0,right:0,bottom:0,width:0,height:0,x:0,y:0}),u=()=>{const e=s.value.getBoundingClientRect();i.left=e.left,i.top=e.top,i.right=e.right,i.bottom=e.bottom,i.width=e.width,i.height=e.height,i.x=e.x,i.y=e.y,null==n||n()};let c=null,d=null;const p=()=>{c&&window.removeEventListener("resize",c),d&&(d.disconnect(),d=null)};return z((()=>{s.value&&(p(),c=u,"throttle"===r&&o>=4?c=E(c,o):"debounce"===r&&o>=4&&(c=S(c,o)),window.addEventListener("resize",c),d=new ResizeObserver(c),d.observe(s.value))})),h(p),t?i:[s,i]}const R={class:"scrollbar__wrapper"};const W=e(D(O({},{name:"CustomScrollbar",inheritAttrs:!1}),{props:{contentClass:null,contentStyle:null,direction:{default:"vertical"},thumbMinSize:{default:48},thumbMaxSize:{default:1/0},autoHide:{default:!0},autoHideDelay:{default:900},autoExpand:{default:!0},fixedThumb:null,throttleType:{default:"debounce"},throttleWait:{default:333},simulateScroll:null},emits:["wrapperResize","contentResize","scroll"],setup:function(e,{expose:h,emit:b}){const m=e,f={horizontal:{el:null,instance:null},vertical:{el:null,instance:null}};let y=l(null),w=l(null);t((()=>{var e;const l=Array.from(null==(e=y.value.parentElement)?void 0:e.childNodes);for(const t in f)f[t].el=l.find((e=>{var l;return null==(l=null==e?void 0:e.classList)?void 0:l.contains(`scrollbar__thumbPlaceholder--${t}`)}))}));const x=C(y,{wait:m.throttleWait,type:m.throttleType,callback:T}),z=C(w,{wait:m.throttleWait,type:m.throttleType,callback:T});let E=l(0),S=l(0);function T(){E.value=Math.max(y.value.scrollHeight-x.height|0,0),S.value=Math.max(y.value.scrollWidth-x.width|0,0)}let L=a((()=>({thumbSize:S.value?_(x.width/y.value.scrollWidth*x.width,m.thumbMinSize>x.width?48:m.thumbMinSize,m.thumbMaxSize):0,contentMainSize:z.width,wrapperMainSize:x.width,boundaryDistance:Math.abs(x.left)}))),P=a((()=>({thumbSize:E.value?_(x.height/y.value.scrollHeight*x.height,m.thumbMinSize>x.height?48:m.thumbMinSize,m.thumbMaxSize):0,contentMainSize:z.height,wrapperMainSize:x.height,boundaryDistance:Math.abs(x.top)}))),H=a((()=>x.height-P.value.thumbSize-5)),M=a((()=>x.width-L.value.thumbSize-5));const I=()=>{S.value&&(f.horizontal.el.style.transform=`translate3d(${y.value.scrollLeft/S.value*M.value}px, 0, 0)`,f.horizontal.instance.autoHideAfterScroll()),E.value&&(f.vertical.el.style.transform=`translate3d(0, ${y.value.scrollTop/E.value*H.value}px, 0)`,f.vertical.instance.autoHideAfterScroll())};o((()=>[S.value,E.value]),I);const $=e=>{m.simulateScroll?(e=>{e.stopPropagation();const l=y.value.scrollLeft,t=y.value.scrollTop,a=0|_(l+((null==e?void 0:e.deltaX)||0),0,S.value),o=0|_(t+((null==e?void 0:e.deltaY)||0),0,E.value);y.value.scrollLeft=a,y.value.scrollTop=o,S.value&&(f.horizontal.el.style.transform=`translate3d(${a/S.value*M.value}px, 0, 0)`,f.horizontal.instance.autoHideAfterScroll()),E.value&&(f.vertical.el.style.transform=`translate3d(0, ${o/E.value*H.value}px, 0)`,f.vertical.instance.autoHideAfterScroll()),b("scroll",{target:y.value,scrollLeft:a,scrollTop:o})})(e):I()};return o(x,(()=>b("wrapperResize",x))),o(z,(()=>b("contentResize",z))),h({scrollEl:y}),(l,t)=>(r(),n("div",R,[s("div",d({ref:(e,l)=>{l.wrapperEl=e,y.value=e},class:"scrollbar__scroller"},l.$attrs,{onWheel:$,onScroll:$}),[s("div",{ref:(e,l)=>{l.contentEl=e,w.value=e},class:i(["scrollbar__content",e.contentClass,{"scrollbar__content--fixedThumb":e.fixedThumb,[`scrollbar__content--${e.direction}`]:e.direction}]),style:u(e.contentStyle)},[c(l.$slots,"default")],6)],16),(r(),n(p,null,v(f,((l,t)=>g(A,{ref:e=>((e,l)=>{f[l].instance||(f[l].instance=e)})(e,t),key:t,autoExpand:e.autoExpand,autoHide:e.autoHide,autoHideDelay:e.autoHideDelay,fixedThumb:t!==e.direction&&e.fixedThumb,type:t,scrollInfo:"vertical"===t?P.value:L.value,wrapperEl:y.value},null,8,["autoExpand","autoHide","autoHideDelay","fixedThumb","type","scrollInfo","wrapperEl"]))),64))]))}}));export{W as _};
